webpackJsonp([1],{"+h1B":function(t,e,i){"use strict";var n=i("/oeL"),r=i("aR8+"),o=i("1OLF"),a=i("q4dy"),s=i("tD1F"),l=i("qbdv"),c=i("fc+i"),p=i("bm2B"),d=i("CPp0"),h=i("CNgE"),u=i("5sOl"),f=i("BkNc"),m=i("bN0p"),y=i("biyL"),g=i("wQAS");i.d(e,"a",function(){return b});var b=n.b(r.a,[o.a],function(t){return n.c([n.d(512,n.e,n.f,[[8,[a.a,s.a]],[3,n.e],n.g]),n.d(5120,n.h,n.i,[[3,n.h]]),n.d(4608,l.a,l.b,[n.h]),n.d(5120,n.j,n.k,[]),n.d(5120,n.l,n.m,[]),n.d(5120,n.n,n.o,[]),n.d(4608,c.b,c.c,[l.c]),n.d(6144,n.p,null,[c.b]),n.d(4608,c.d,c.e,[]),n.d(5120,c.f,function(t,e,i,n){return[new c.g(t),new c.h(e),new c.i(i,n)]},[l.c,l.c,l.c,c.d]),n.d(4608,c.j,c.j,[c.f,n.q]),n.d(135680,c.k,c.k,[l.c]),n.d(4608,c.l,c.l,[c.j,c.k]),n.d(6144,n.r,null,[c.l]),n.d(6144,c.m,null,[c.k]),n.d(4608,n.s,n.s,[n.q]),n.d(4608,c.n,c.n,[l.c]),n.d(4608,c.o,c.o,[l.c]),n.d(4608,p.a,p.a,[]),n.d(4608,d.a,d.a,[]),n.d(4608,d.b,d.c,[]),n.d(5120,d.d,d.e,[]),n.d(4608,d.f,d.f,[d.a,d.b,d.d]),n.d(4608,d.g,d.h,[]),n.d(5120,d.i,d.j,[d.f,d.g]),n.d(5120,h.a,h.b,[]),n.d(5120,u.a,u.b,[c.p,h.a,[3,u.a]]),n.d(5120,f.a,f.b,[f.c]),n.d(4608,f.d,f.d,[]),n.d(6144,f.e,null,[f.d]),n.d(135680,f.f,f.f,[f.c,n.t,n.u,n.v,f.e]),n.d(4608,f.g,f.g,[]),n.d(5120,f.h,f.i,[f.j]),n.d(5120,n.w,function(t){return[t]},[f.h]),n.d(512,l.d,l.d,[]),n.d(1024,n.x,c.q,[]),n.d(1024,n.y,function(){return[f.k()]},[]),n.d(512,f.j,f.j,[n.v]),n.d(1024,n.z,function(t,e,i){return[c.r(t,e),f.l(i)]},[[2,c.s],[2,n.y],f.j]),n.d(512,n.A,n.A,[[2,n.z]]),n.d(131584,n.B,n.B,[n.q,n.C,n.v,n.x,n.e,n.A]),n.d(2048,n.D,null,[n.B]),n.d(512,n.E,n.E,[n.D]),n.d(512,c.t,c.t,[[3,c.t]]),n.d(512,p.b,p.b,[]),n.d(512,p.c,p.c,[]),n.d(512,d.k,d.k,[]),n.d(512,h.c,h.c,[]),n.d(512,m.a,m.a,[]),n.d(512,y.AceEditorModule,y.AceEditorModule,[]),n.d(1024,f.m,f.n,[[3,f.c]]),n.d(512,f.o,f.p,[]),n.d(512,f.q,f.q,[]),n.d(256,f.r,{useHash:!0},[]),n.d(1024,l.e,f.s,[l.f,[2,l.g],f.r]),n.d(512,l.h,l.h,[l.e]),n.d(512,n.u,n.u,[]),n.d(512,n.t,n.F,[n.u,[2,n.G]]),n.d(1024,f.t,function(){return[[{path:"whittles/:readUUID/write/:writeUUID",component:g.a},{path:"whittles/:readUUID",component:g.a},{path:"",component:g.a}]]},[]),n.d(1024,f.c,f.u,[n.D,f.o,f.q,l.h,n.v,n.t,n.u,f.t,f.r,[2,f.v],[2,f.w]]),n.d(512,f.x,f.x,[[2,f.m],[2,f.c]]),n.d(512,r.a,r.a,[])])})},"/Qo4":function(t,e,i){"use strict";function n(t){return a._25(0,[a._32(402653184,1,{editor:0}),(t()(),a._26(0,null,null,2,"ace-editor",[["style","height:100%;"]],null,[[null,"textChanged"],[null,"readOnlyChange"]],function(t,e,i){var n=!0,r=t.component;if("textChanged"===e){n=!1!==r.handleUserEntry(i)&&n}if("readOnlyChange"===e){n=!1!==(r.readOnly=i)&&n}return n},l.a,l.b)),a._35(5120,null,c.d,function(t){return[t]},[p.AceEditorComponent]),a._27(49152,[[1,4],["editor",4]],0,p.AceEditorComponent,[a.P],{style:[0,"style"],readOnly:[1,"readOnly"],theme:[2,"theme"],mode:[3,"mode"]},{textChanged:"textChanged"}),(t()(),a._30(null,["\n"]))],function(t,e){t(e,3,0,"height:100%;",e.component.readOnly,"tomorrow","yaml")},null)}function r(t){return a._25(0,[(t()(),a._26(0,null,null,1,"yaml-entry",[],null,null,null,n,h)),a._27(114688,null,0,s.a,[],null,null)],function(t,e){t(e,1,0)},null)}var o=i("EUB7"),a=i("/oeL"),s=i("UhKd"),l=i("cqgc"),c=i("bm2B"),p=i("8ymd");i.d(e,"b",function(){return h}),e.a=n;var d=[o.a],h=a._24({encapsulation:0,styles:d,data:{}});a._28("yaml-entry",s.a,r,{readOnly:"readOnly"},{stixChanged:"stixChanged"},[])},0:function(t,e,i){t.exports=i("cDNt")},"0nlO":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"intrusion-set",description:"An Intrusion Set is a grouped set of adversary behavior and resources with common properties that is believed to be orchestrated by a single organization.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `intrusion-set`.",enum:["intrusion-set"]},id:{title:"id",pattern:"^intrusion-set--"},name:{type:"string",description:"The name used to identify the Intrusion Set."},description:{type:"string",description:"Provides more context and details about the Intrusion Set object."},aliases:{type:"array",description:"Alternative names used to identify this Intrusion Set.",items:{type:"string"},minItems:1},first_seen:{$ref:"../common/timestamp.json",description:"The time that this Intrusion Set was first seen."},last_seen:{$ref:"../common/timestamp.json",description:"The time that this Intrusion Set was last seen."},goals:{type:"array",description:"The high level goals of this Intrusion Set, namely, what are they trying to do.",items:{type:"string"},minItems:1},resource_level:{type:"string",description:"This defines the organizational level at which this Intrusion Set typically works. Open Vocab - attack-resource-level-ov"},primary_motivation:{type:"string",description:"The primary reason, motivation, or purpose behind this Intrusion Set. Open Vocab - attack-motivation-ov"},secondary_motivations:{type:"array",description:"The secondary reasons, motivations, or purposes behind this Intrusion Set. Open Vocab - attack-motivation-ov",items:{type:"string"},minItems:1}}}],required:["name"],definitions:{"attack-resource-level-ov":{type:"string",enum:["individual","club","contest","team","organization","government"]},"attack-motivation-ov":{type:"string",enum:["accidental","coercion","dominance","ideology","notoriety","organizational-gain","personal-gain","personal-satisfaction","revenge","unpredictable"]}}}},"0vbN":function(t,e,i){"use strict";function n(t){return a._25(0,[(t()(),a._26(0,null,null,2,"pre",[["id","raw-stix"]],null,null,null,null,null)),(t()(),a._30(null,["",""])),a._33(0,s.n,[]),(t()(),a._30(null,["\n"]))],null,function(t,e){var i=e.component;t(e,1,0,a._34(e,1,0,a._29(e,2).transform(i.rawStix)))})}function r(t){return a._25(0,[(t()(),a._26(0,null,null,1,"raw-stix",[],null,null,null,n,p)),a._27(114688,null,0,l.a,[],null,null)],function(t,e){t(e,1,0)},null)}var o=i("nF49"),a=i("/oeL"),s=i("qbdv"),l=i("PtbZ");i.d(e,"b",function(){return p}),e.a=n;var c=[o.a],p=a._24({encapsulation:0,styles:c,data:{}});a._28("raw-stix",l.a,r,{rawStix:"rawStix"},{},[])},"1OLF":function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(){function t(){}return t.ctorParameters=function(){return[]},t}()},"25Yh":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"dictionary",description:"A dictionary captures a set of key/value pairs",type:"object",patternProperties:{"^[a-zA-Z0-9_-]{3,256}$":{anyOf:[{type:"array",minItems:1},{type:"string"},{type:"integer"},{type:"boolean"},{type:"number"},{type:"object"}]}},additionalProperties:!1}},"29Wl":function(t,e,i){"use strict";var n=i("aMZo"),r=(i.n(n),i("LT4L"));i.n(r);i.d(e,"a",function(){return o});var o;!function(t){function e(e){return t.sroTypes.indexOf(e.type)>-1?r.validateResult(e,t.schemas.sros[e.type]):t.sdoTypes.indexOf(e.type)>-1?r.validateResult(e,t.schemas.sdos[e.type]):null}function o(){["common","sdos","sros"].forEach(function(e){for(var i in t.schemas[e]){var n="/stix/"+e+"/"+i+".json";t.schemas[e][i].$id=n,r.addSchema(n,t.schemas[e][i])}})}t.sroTypes=["relationship","sighting"],t.sdoTypes=["attack-pattern","campaign","course-of-action","identity","indicator","intrusion-set","malware","observed-data","report","threat-actor","tool","vulnerability"],t.schemas={common:i("ZZDU"),sdos:i("ivPj"),sros:i("j//H")};var a=function(){function t(){this.type="bundle",this.id="bundle--"+n.v4(),this.spec_version="2.0",this.objects=[]}return t}();t.Bundle=a;var s=function(){function t(t,e){var i=(new Date).toISOString();this.type=t,this.id=e.id||this.generateId(t),this.created=e.created||i,"data-marking"!=this.type&&(this.modified=e.modified||i);for(var n in e)this[n]=e[n]}return t.prototype.generateId=function(t){return t+"--"+n.v4()},t.prototype.valid=function(){var t=e(JSON.parse(JSON.stringify(this)));return null!==t&&console.log(t),t},t}();t.Object=s,t.validate=e,t.initValidator=o}(o||(o={}))},"2S+5":function(t,e,i){"use strict";function n(t){return a._25(0,[a._32(402653184,1,{d3Container:0}),(t()(),a._26(0,[[1,0],["d3container",1]],null,0,"div",[["id","d3container"]],null,null,null,null,null)),(t()(),a._30(null,["\n"]))],null,null)}function r(t){return a._25(0,[(t()(),a._26(0,null,null,1,"visualizer",[],null,null,null,n,c)),a._27(114688,null,0,s.a,[a.P],null,null)],function(t,e){t(e,1,0)},null)}var o=i("plal"),a=i("/oeL"),s=i("I0Gh");i.d(e,"b",function(){return c}),e.a=n;var l=[o.a],c=a._24({encapsulation:2,styles:l,data:{}});a._28("visualizer",s.a,r,{},{},[])},"2u+x":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"attack-pattern",description:"Attack Patterns are a type of TTP that describe ways that adversaries attempt to compromise targets. ",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `attack-pattern`.",enum:["attack-pattern"]},id:{title:"id",pattern:"^attack-pattern--"},name:{type:"string",description:"The name used to identify the Attack Pattern."},description:{type:"string",description:"A description that provides more details and context about the Attack Pattern, potentially including its purpose and its key characteristics."},kill_chain_phases:{type:"array",description:"The list of kill chain phases for which this attack pattern is used.",items:{$ref:"../common/kill-chain-phase.json"},minItems:1}}}],required:["name"]}},"3Ya+":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"url",description:"Matches the elements of a URL using a regular expression. Uses Diego Perini's regex from https://gist.github.com/dperini/729294.",type:"string",pattern:"^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z¡-￿0-9]-*)*[a-z¡-￿0-9]+)(?:\\.(?:[a-z¡-￿0-9]-*)*[a-z¡-￿0-9]+)*(?:\\.(?:[a-z¡-￿]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$"}},"62kW":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"timestamp",description:"Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",type:"string",pattern:"^[0-9]{4}-[0-9]{2}-[0-9]{2}T[0-9]{2}:[0-9]{2}:[0-9]{2}(\\.[0-9]+)?Z$"}},"7YP6":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"tool",description:"Tools are legitimate software that can be used by threat actors to perform attacks.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `tool`.",enum:["tool"]},id:{title:"id",pattern:"^tool--"},labels:{type:"array",description:"The kind(s) of tool(s) being described. Open Vocab - tool-label-ov",items:{type:"string"},minItems:1},name:{type:"string",description:"The name used to identify the Tool."},description:{type:"string",description:"Provides more context and details about the Tool object."},tool_version:{type:"string",description:"The version identifier associated with the tool."},kill_chain_phases:{type:"array",description:"The list of kill chain phases for which this Tool instance can be used.",items:{$ref:"../common/kill-chain-phase.json"},minItems:1}}}],required:["name","labels"],definitions:{"tool-label-ov":{type:"string",enum:["denial-of-service","exploitation","information-gathering","network-capture","credential-exploitation","remote-access","vulnerability-scanning"]}}}},"9AbJ":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"dictionary",description:"A dictionary captures a set of key/value pairs",type:"object",patternProperties:{"^[a-zA-Z0-9_-]{1,}$":{type:"string",description:"Custom hash key"},"^MD5$":{type:"string",description:"Specifies the MD5 message digest algorithm.",pattern:"^[a-fA-F0-9]{32}$"},"^MD6$":{type:"string",description:"Specifies the MD6 message digest algorithm.",pattern:"^[a-fA-F0-9]{32}|[a-fA-F0-9]{40}|[a-fA-F0-9]{56}|[a-fA-F0-9]{64}|[a-fA-F0-9]{96}|[a-fA-F0-9]{128}$"},"^RIPEMD-160$":{type:"string",description:"Specifies the RIPEMD­-160 (R​ACE​ Integrity Primitives Evaluation Message Digest)​ cryptographic hash function.",pattern:"^[a-fA-F0-9]{40}$"},"^SHA-1$":{type:"string",description:"Specifies the SHA­-1 (secure-­hash algorithm 1) cryptographic hash function.",pattern:"^[a-fA-F0-9]{40}$"},"^SHA-224$":{type:"string",description:"Specifies the SHA-­224 cryptographic hash function (part of the SHA­2 family).",pattern:"^[a-fA-F0-9]{56}$"},"^SHA-256$":{type:"string",description:"Specifies the SHA-­256 cryptographic hash function (part of the SHA­2 family).",pattern:"^[a-fA-F0-9]{64}$"},"^SHA-384$":{type:"string",description:"Specifies the SHA-­384 cryptographic hash function (part of the SHA­2 family).",pattern:"^[a-fA-F0-9]{96}$"},"^SHA-512$":{type:"string",description:"Specifies the SHA-­512 cryptographic hash function (part of the SHA­2 family).",pattern:"^[a-fA-F0-9]{128}$"},"^SHA3-224$":{type:"string",description:"Specifies the SHA3-224 cryptographic hash function.",pattern:"^[a-fA-F0-9]{56}$"},"^SHA3-256$":{type:"string",description:"Specifies the SHA3-256 cryptographic hash function.",pattern:"^[a-fA-F0-9]{64}$"},"^SHA3-384$":{type:"string",description:"Specifies the SHA3-384 cryptographic hash function.",pattern:"^[a-fA-F0-9]{96}$"},"^SHA3-512$":{type:"string",description:"Specifies the SHA3-512 cryptographic hash function.",pattern:"^[a-fA-F0-9]{128}$"},"^ssdeep$":{type:"string",description:"Specifies the ssdeep fuzzy hashing algorithm.",pattern:"^[a-zA-Z0-9/+:.]{1,128}$"},"^WHIRLPOOL$":{type:"string",description:"Specifies the whirlpool cryptographic hash function",pattern:"^[a-fA-F0-9]{128}$"}},additionalProperties:!1}},"B+1Q":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"bundle",description:"A Bundle is a collection of arbitrary STIX Objects and Marking Definitions grouped together in a single container.",type:"object",properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `bundle`.",enum:["bundle"]},id:{allOf:[{$ref:"identifier.json",description:"An identifier for this bundle. The id field for the Bundle is designed to help tools that may need it for processing, but tools are not required to store or track it. "},{title:"id",pattern:"^bundle--"}]},spec_version:{type:"string",enum:["2.0"],description:"The version of the STIX specification used to represent the content in this bundle."},objects:{type:"array",description:"Specifies a set of one or more STIX Objects.",items:{anyOf:[{oneOf:[{$ref:"../sdos/attack-pattern.json"},{$ref:"../sdos/campaign.json"},{$ref:"../sdos/course-of-action.json"},{$ref:"../sdos/identity.json"},{$ref:"../sdos/indicator.json"},{$ref:"../sdos/intrusion-set.json"},{$ref:"../sdos/malware.json"},{$ref:"marking-definition.json"},{$ref:"../sdos/observed-data.json"},{$ref:"../sros/relationship.json"},{$ref:"../sdos/report.json"},{$ref:"../sros/sighting.json"},{$ref:"../sdos/threat-actor.json"},{$ref:"../sdos/tool.json"},{$ref:"../sdos/vulnerability.json"}]},{allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which for custom objects cannot be one of those defined in the specification.",not:{enum:["attack-pattern","campaign","course-of-action","identity","indicator","intrusion-set","malware","marking-definition","observed-data","relationship","report","sighting","threat-actor","tool","vulnerability"]}}}}]}]},minItems:1}},required:["type","id","spec_version"]}},DI0P:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"vulnerability",description:"A Vulnerability is a mistake in software that can be directly used by a hacker to gain access to a system or network.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `vulnerability`.",enum:["vulnerability"]},id:{title:"id",pattern:"^vulnerability--"},name:{type:"string",description:"The name used to identify the Vulnerability."},description:{type:"string",description:"A description that provides more details and context about the Vulnerability."}}}],required:["name"]}},DQMi:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"kill-chain-phase",description:"The kill-chain-phase represents a phase in a kill chain.",type:"object",properties:{kill_chain_name:{type:"string",description:"The name of the kill chain."},phase_name:{type:"string",description:"The name of the phase in the kill chain."}},required:["kill_chain_name","phase_name"]}},EOk5:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"identifier",description:"Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",type:"string",pattern:"^[a-z][a-z-]+[a-z]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"}},EUB7:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=[""]},I0Gh:function(t,e,i){"use strict";var n=i("/oeL"),r=i("0z5Q");i.n(r);i.d(e,"a",function(){return o});var o=function(){function t(t){this.margin={top:20,bottom:20,left:20,right:20},this.nodes=[],this.edges=[],this.initialized=!1}return t.prototype.ngOnInit=function(){this.createViz()},t.prototype.createViz=function(){var t=this,e=this.d3Container.nativeElement;this.width=e.offsetWidth-this.margin.left-this.margin.right,this.height=e.offsetHeight-this.margin.top-this.margin.bottom,this.width<this.height?this.minSize=this.width:this.minSize=this.height,this.svg=r.select(e).append("svg").attr("width",e.offsetWidth-20).attr("height",e.offsetHeight-20),this.svg.append("g").attr("class","links"),this.svg.append("g").attr("class","nodes"),this.forceLayout=r.forceSimulation().force("charge",r.forceManyBody().strength(-2*this.minSize).distanceMax(this.minSize/2)).force("center",r.forceCenter(this.width/2,this.height/2)).force("collide",r.forceCollide().radius(40)),this.forceLayout.on("tick",function(){void 0!==t.edge&&(t.edge.select("path").attr("d",function(t){t.target.x,t.source.x,t.target.y,t.source.y;return"M"+t.source.x+","+t.source.y+"A0,0 0 0,1 "+t.target.x+","+t.target.y}),t.node.attr("transform",function(t){return"translate("+(t.x-15)+","+(t.y-15)+")"}),t.edgeLabels.attr("transform",function(t,e){if(t.target.x<t.source.x){var i=this.getBBox();return"rotate(180 "+(i.x+i.width/2)+" "+(i.y+i.height/2)+")"}return"rotate(0)"}))}),this.svg.append("svg:defs").selectAll("marker").data(["end"]).enter().append("svg:marker").attr("id",String).attr("viewBox","0 -5 10 10").attr("refX",33).attr("refY",0).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").style("stroke-width",0).style("fill","#aaa").append("svg:path").attr("d","M0,-5L10,0L0,5"),this.initialized=!0},t.prototype.visualize=function(t){var e=this;if(this.currentlyShowing=t,this.initialized){this.processData(t),this.edge=this.svg.select("g.links").selectAll(".link").data(this.edges,function(t){return t.id});var i=this.edge.enter().append("g").attr("class","link");i.append("path").attr("id",function(t){return"path-"+t.id}),i.append("text").append("textPath").attr("xlink:href",function(t){return"#path-"+t.id}).attr("startOffset","50%");this.edge.exit().remove();this.edge=i.merge(this.edge),this.edge.select("textPath").text(function(t){return t.label}),this.edgeLabels=this.edge.select("text"),this.node=this.svg.select("g.nodes").selectAll(".node").data(this.nodes,function(t){return t.id});var n=this.node.enter().append("g").attr("class","node");n.append("image").attr("xlink:href",function(t){return"icons/"+t.type+".png"}).attr("width",30).attr("height",30),n.append("title"),n.append("text").attr("dx",40).attr("dy",20);this.node.exit().remove();this.node=n.merge(this.node),this.node.select("title").text(function(t){return t.name}),this.node.select("text").text(function(t){return t.name}),this.node.call(r.drag().on("start",function(t){r.event.active||e.forceLayout.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y}).on("drag",function(t){t.fx=r.event.x,t.fy=r.event.y}).on("end",function(t){r.event.active||e.forceLayout.alphaTarget(0),t.fx=null,t.fy=null}))}},t.prototype.processData=function(t){var e=this;this.forceLayout.stop();var i=this.nodes.reduce(function(t,e){return t[e.id]=e,t},{});this.nodes=t.objects.filter(function(t){return"relationship"!==t.type}).map(function(t){return Object.assign({},t)}),this.nodes.forEach(function(t){i[t.id]&&(t.x=i[t.id].x,t.y=i[t.id].y,t.vx=i[t.id].vx,t.vy=i[t.id].vy)}),this.edges=[],t.objects.forEach(function(i){if("relationship"==i.type){if(i.source_ref&&i.target_ref){var n=t.objects.find(function(t){return t.id==i.source_ref}),r=t.objects.find(function(t){return t.id==i.target_ref});n&&"relationship"!=n.type&&r&&"relationship"!=r.type&&e.edges.push({id:i.id,source:i.source_ref,target:i.target_ref,label:i.relationship_type})}}else{for(var o in i)!function(n){if(n.match(/_ref$/))t.objects.find(function(t){return t.id===i[n].id})&&e.edges.push({id:i.id+n,source:i.id,target:i[n],label:n});else if(n.match(/_refs$/))for(var r=0,o=i[n];r<o.length;r++){var a=o[r];!function(r){t.objects.find(function(t){return t.id===r})&&e.edges.push({id:i.id+n+r,source:i.id,target:r,label:n})}(a)}}(o)}}),this.forceLayout.nodes(this.nodes),this.forceLayout.force("link",r.forceLink(this.edges).id(function(t){return t.id}).distance(200)),this.forceLayout.alpha(1).restart()},t.ctorParameters=function(){return[{type:n.P}]},t}()},Jw0n:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"relationship",description:"The Relationship object is used to link together two SDOs in order to describe how they are related to each other.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `relationship`.",enum:["relationship"]},id:{title:"id",pattern:"^relationship--"},relationship_type:{type:"string",description:"The name used to identify the type of relationship.",pattern:"^[a-z0-9\\-]+$"},description:{type:"string",description:"A description that helps provide context about the relationship."},source_ref:{description:"The ID of the source (from) object.",allOf:[{$ref:"../common/identifier.json"},{not:{pattern:"^(relationship|sighting|bundle|marking-definition)--.+$"}}]},target_ref:{description:"The ID of the target (to) object.",allOf:[{$ref:"../common/identifier.json"},{not:{pattern:"^(relationship|sighting|bundle|marking-definition)--.+$"}}]}}}],required:["relationship_type","source_ref","target_ref"]}},NhKt:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=[".text-panel[_ngcontent-%COMP%]{right:50%;left:0;bottom:15px;margin:0;padding:15px}.text-panel[_ngcontent-%COMP%], .viz-panel[_ngcontent-%COMP%]{position:absolute;top:100px}.viz-panel[_ngcontent-%COMP%]{right:0;left:50%;bottom:0}yaml-entry[_ngcontent-%COMP%]{height:50%;font-size:12px;top:0;bottom:50%}raw-stix[_ngcontent-%COMP%], yaml-entry[_ngcontent-%COMP%]{position:absolute;left:0;right:0;border:1px solid #eee;border-bottom:0}raw-stix[_ngcontent-%COMP%]{margin:15px 0 0 0;padding:0 15px 15px 15px;top:50%;bottom:15px;overflow-y:scroll}#copy-json[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;font-family:Source Sans Pro;font-size:14px}body[_ngcontent-%COMP%]{padding:0}body[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{margin:0}h1[_ngcontent-%COMP%]{font-family:Source Code Pro,monospace;font-size:36px;font-weight:lighter;float:left}h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:18px;margin-left:20px;display:inline-block;color:#ccc}#help-overlay[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-family:Source Sans Pro}#help-overlay[_ngcontent-%COMP%]{padding:0 50px;color:#999;font-size:16px;z-index:100}#help-overlay[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#aaa;font-size:24px}.section[_ngcontent-%COMP%]:first-child{float:right;width:400px}.section[_ngcontent-%COMP%]:last-child{float:left;width:200px}.section[_ngcontent-%COMP%]   .example[_ngcontent-%COMP%]{white-space:pre-wrap;font-family:Source Code Pro}#help-overlay[_ngcontent-%COMP%], #visualizer[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;right:0;left:0}.links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;float:right;clear:both}.sharing-link[_ngcontent-%COMP%]{float:right;font-family:Source Sans Pro;font-size:14px}button[_ngcontent-%COMP%]{color:transparent;background-color:transparent;cursor:pointer;border:0}.sharing-link[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{text-indent:-2000px;overflow:hidden;width:48px;height:48px;background-image:url(https://johnwunder.github.io/cti-whittler/icons/eye.png);display:inline-block;opacity:.6}.sharing-link[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:1}.sharing-link[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-left:25px;width:400px;border:none;border-bottom:1px solid #ccc;font-family:Source Sans Pro;font-size:14px;padding:2px}"]},OQ75:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"external-reference",description:"External references are used to describe pointers to information represented outside of STIX.",type:"object",properties:{description:{type:"string",description:"A human readable description"},url:{$ref:"url-regex.json",description:"A URL reference to an external resource."}},oneOf:[{properties:{source_name:{type:"string",description:"The source within which the external-reference is defined (system, registry, organization, etc.)",pattern:"^cve$"},external_id:{type:"string",description:"An identifier for the external reference content.",pattern:"^CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,})$"}},required:["source_name","external_id"]},{properties:{source_name:{type:"string",description:"The source within which the external-reference is defined (system, registry, organization, etc.)",pattern:"^capec$"},external_id:{type:"string",description:"An identifier for the external reference content.",pattern:"^CAPEC-\\d+$"}},required:["source_name","external_id"]},{properties:{source_name:{type:"string",description:"The source within which the external-reference is defined (system, registry, organization, etc.)",not:{pattern:"^(cve)|(capec)$"}},external_id:{type:"string",description:"An identifier for the external reference content.",not:{pattern:"^(CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,}))|(CAPEC-\\d+)$"}}},required:["source_name"],anyOf:[{required:["external_id"]},{required:["description"]},{required:["url"]}]}]}},"P+H8":function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"granular-marking",description:"The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",type:"object",properties:{selectors:{type:"array",description:"A list of selectors for content contained within the STIX object in which this property appears.",items:{type:"string",pattern:"^[a-z0-9_-]{3,250}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*$"},minItems:1},marking_ref:{$ref:"identifier.json",pattern:"^marking-definition--",description:"The marking_ref property specifies the ID of the marking-definition object that describes the marking."}},required:["selectors","marking_ref"]}},PgoS:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"marking-definition",description:"The marking-definition object represents a specific marking.",type:"object",properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `marking-definition`.",enum:["marking-definition"]},id:{allOf:[{$ref:"identifier.json",description:"An identifier for this bundle."},{title:"id",pattern:"^marking-definition--"}]},created_by_ref:{$ref:"identifier.json",description:"The created_by_ref property specifies the ID of the identity object that describes the entity that created this Marking Definition."},created:{$ref:"timestamp.json",description:"The created property represents the time at which the first version of this Marking Definition object was created."},external_references:{type:"array",description:"A list of external references which refers to non-STIX information.",items:{$ref:"external-reference.json"},minItems:1},object_marking_refs:{type:"array",description:"The object_marking_refs property specifies a list of IDs of marking-definition objects that apply to this Marking Definition.",items:{$ref:"identifier.json",pattern:"^marking-definition--"},minItems:1},granular_markings:{type:"array",description:"The granular_markings property specifies a list of granular markings applied to this object.",items:{$ref:"granular-marking.json"},minItems:1}},oneOf:[{properties:{definition_type:{type:"string",description:"The definition_type property identifies the type of Marking Definition.",pattern:"^statement$"},definition:{$ref:"#/definitions/statement",description:"The definition property contains the marking object itself."}}},{properties:{definition_type:{type:"string",description:"The definition_type property identifies the type of Marking Definition.",pattern:"^tlp$"},definition:{$ref:"#/definitions/tlp",description:"The definition property contains the marking object itself."}}},{properties:{definition_type:{type:"string",description:"The definition_type property identifies the type of Marking Definition.",not:{pattern:"^(statement)|(tlp)$"}},definition:{type:"object",description:"The definition property contains the marking object itself."}}}],required:["id","type","definition","definition_type","created"],definitions:{statement:{type:"object",description:"The Statement marking type defines the representation of a textual marking statement (e.g., copyright, terms of use, etc.) in a definition",properties:{statement:{type:"string",description:"A statement (e.g., copyright, terms of use) applied to the content marked by this marking definition."}},required:["statement"]},tlp:{type:"object",description:"The TLP marking type defines how you would represent a Traffic Light Protocol (TLP) marking in a definition field.",properties:{tlp:{type:"string",description:"The TLP level of the content marked by this marking definition, as defined in this section.",enum:["white","green","amber","red"]}},required:["tlp"]}}}},PtbZ:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=function(){function t(){}return t.prototype.ngOnInit=function(){},t.ctorParameters=function(){return[]},t}()},Q83H:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"sighting",description:"A Sighting denotes the belief that something in CTI (e.g., an indicator, malware, tool, threat actor, etc.) was seen.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `sighting`.",enum:["sighting"]},id:{title:"id",pattern:"^sighting--"},first_seen:{$ref:"../common/timestamp.json",description:"The beginning of the time window during which the SDO referenced by the sighting_of_ref property was sighted."},last_seen:{$ref:"../common/timestamp.json",description:"The end of the time window during which the SDO referenced by the sighting_of_ref property was sighted."},count:{type:"integer",description:"This is an integer between 0 and 999,999,999 inclusive and represents the number of times the object was sighted.",minimum:0,maximum:999999999},sighting_of_ref:{$ref:"../common/identifier.json",not:{anyOf:[{pattern:"^sighting--"},{pattern:"^relationship--"}]},description:"An ID reference to the object that has been sighted."},observed_data_refs:{type:"array",description:"A list of ID references to the Observed Data objects that contain the raw cyber data for this Sighting.",items:{$ref:"../common/identifier.json",pattern:"^observed-data--"},minItems:1},where_sighted_refs:{type:"array",description:"The ID of the Victim Target objects of the entities that saw the sighting.",items:{$ref:"../common/identifier.json",pattern:"^identity--"},minItems:1},summary:{type:"boolean",description:"The summary property indicates whether the Sighting should be considered summary data. "}}}],required:["sighting_of_ref"]}},Sxy1:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"identity",description:"Identities can represent actual individuals, organizations, or groups (e.g., ACME, Inc.) as well as classes of individuals, organizations, or groups.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `identity`.",enum:["identity"]},id:{title:"id",pattern:"^identity--"},labels:{type:"array",description:"The list of roles that this Identity performs (e.g., CEO, Domain Administrators, Doctors, Hospital, or Retailer). No open vocabulary is yet defined for this property.",items:{type:"string"},minItems:1},name:{type:"string",description:"The name of this Identity."},description:{type:"string",description:"A description that provides more details and context about the Identity."},identity_class:{type:"string",description:"The type of entity that this Identity describes, e.g., an individual or organization. Open Vocab - identity-class-ov"},sectors:{type:"array",description:"The list of sectors that this Identity belongs to. Open Vocab - industry-sector-ov",items:{type:"string"},minItems:1},contact_information:{type:"string",description:"The contact information (e-mail, phone number, etc.) for this Identity."}}}],required:["name","identity_class"],definitions:{"identity-class-ov":{type:"string",enum:["individual","group","organization","class","unknown"]},"industry-sector-ov":{type:"string",enum:["agriculture","aerospace","automotive","communications","construction","defence","education","energy","engineering","entertainment","financial-services","government-national","government-regional","government-local","government-public-services","healthcare","hospitality-leisure","infrastructure","insurance","manufacturing","mining","non-profit","pharmaceuticals","retail","technology","telecommunications","transportation","utilities"]}}}},UhKd:function(t,e,i){"use strict";var n=i("/oeL"),r=i("29Wl"),o=i("XNK7");i.n(o);i.d(e,"a",function(){return a});var a=(ace.require("ace/range").Range,function(){function t(){this.stixChanged=new n.V,this.settingText=!1,this.bundle=new r.a.Bundle}return t.prototype.ngOnInit=function(){r.a.initValidator()},t.prototype.handleUserEntry=function(t){this.settingText||(this.editor.text=t,this.generateSTIX(t),this.stixChanged.emit({bundle:this.bundle,text:this.editor.text,persist:!0}))},t.prototype.handleNewStix=function(t){this.settingText=!0,this.editor.text=t,this.settingText=!1,this.generateSTIX(t),this.stixChanged.emit({bundle:this.bundle,text:this.editor.text,persist:!1})},t.prototype.splitObjects=function(t){return t.split(/(?: *\n *\n)+/g).map(function(t){return t.trim()})},t.prototype.createStixObjects=function(t){for(var e=this,i=t.map(function(t,i){try{return e.createStixObject(t,e.bundle.objects[i])}catch(t){return null}}).filter(function(t){return null!==t&&void 0!==t}),n=0,r=i;n<r.length;n++){var o=r[n];this.resolveRelationships(o,i)}return i},t.prototype.createStixObject=function(t,e){var i=o.safeLoad(t);if(!(i instanceof Object))return null;var n=Object.keys(i)[0];if(i[n]instanceof Object){var a=i[n];return e&&e.type==n&&(a.id=e.id),new r.a.Object(n,i[n])}},t.prototype.generateSTIX=function(t){var e=this.splitObjects(t);null!==e&&e.length>0&&(this.bundle.objects=this.createStixObjects(e))},t.prototype.resolveRelationships=function(t,e){for(var i in t)if(i.match(/_ref$/))t[i]=this.resolveRelationship(t[i],e);else if(i.match(/_refs$/)&&t[i].constructor===Array)for(var n=0;n<t[i].length;n++)t[i][n]=this.resolveRelationship(t[i][n],e)},t.prototype.resolveRelationship=function(t,e){if("number"==typeof t&&e[t])return e[t].id;var i=e.find(function(e){return e.name===t});return i?i.id:null},t.ctorParameters=function(){return[]},t}())},YQ02:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"malware",description:"MMalware is a type of TTP that is also known as malicious code and malicious software, refers to a program that is inserted into a system, usually covertly, with the intent of compromising the confidentiality, integrity, or availability of the victim's data, applications, or operating system (OS) or of otherwise annoying or disrupting the victim.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `malware`.",enum:["malware"]},id:{title:"id",pattern:"^malware--"},labels:{type:"array",description:"The type of malware being described. Open Vocab - malware-label-ov",items:{type:"string"},minItems:1},name:{type:"string",description:"The name used to identify the Malware."},description:{type:"string",description:"Provides more context and details about the Malware object."},kill_chain_phases:{type:"array",description:"The list of kill chain phases for which this Malware instance can be used.",items:{$ref:"../common/kill-chain-phase.json"},minItems:1}}}],required:["name","labels"],definitions:{"malware-label-ov":{type:"string",enum:["adware","backdoor","bot","ddos","dropper","exploit-kit","keylogger","ransomware","remote-access-trojan","resource-exploitation","rogue-security-software","rootkit","screen-capture","spyware","trojan","virus","worm"]}}}},YXct:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"indicator",description:"Indicators contain a pattern that can be used to detect suspicious or malicious cyber activity.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `indicator`.",enum:["indicator"]},id:{title:"id",pattern:"^indicator--"},labels:{type:"array",description:"This field is an Open Vocabulary that specifies the type of indicator. Open vocab - indicator-label-ov",items:{type:"string"},minItems:1},name:{type:"string",description:"The name used to identify the Indicator."},description:{type:"string",description:"A description that provides the recipient with context about this Indicator potentially including its purpose and its key characteristics."},pattern:{type:"string",description:"The detection pattern for this indicator. The default language is STIX Patterning."},valid_from:{$ref:"../common/timestamp.json",description:"The time from which this indicator should be considered valuable intelligence."},valid_until:{$ref:"../common/timestamp.json",description:"The time at which this indicator should no longer be considered valuable intelligence."},kill_chain_phases:{type:"array",description:"The phases of the kill chain that this indicator detects.",items:{$ref:"../common/kill-chain-phase.json",minItems:1}}}}],required:["pattern","labels","valid_from"],definitions:{"indicator-label-ov":{type:"string",enum:["anomalous-activity","anonymization","benign","compromised","malicious-activity","attribution"]}}}},ZZDU:function(t,e,i){e.bundle=i("B+1Q"),e.core=i("bouY"),e["cyber-observable-core"]=i("bExo"),e.dictionary=i("25Yh"),e["external-reference"]=i("OQ75"),e["granular-marking"]=i("P+H8"),e["hashes-type"]=i("9AbJ"),e.hex=i("Zojp"),e.identifier=i("EOk5"),e["kill-chain-phase"]=i("DQMi"),e["marking-definition"]=i("PgoS"),e.timestamp=i("62kW"),e["url-regex"]=i("3Ya+")},Zojp:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"hex",description:"The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",type:"string",pattern:"^([a-fA-F0-9]{2})+$"}},"aR8+":function(t,e,i){"use strict";var n=i("fc+i"),r=i("bm2B"),o=i("CPp0"),a=i("BkNc"),s=i("FHn3"),l=(i.n(s),i("lQgG")),c=i("wQAS"),p=i("13je"),d=i("B2Lq"),h=i("p5Ee");i.d(e,"a",function(){return m});var u=[{path:"whittles/:readUUID/write/:writeUUID",component:c.a},{path:"whittles/:readUUID",component:c.a},{path:"",component:c.a}],f=[n.t,r.c,o.k,l.a,s.AceEditorModule,a.x.forRoot(u,{useHash:!0})];h.a.firebase&&(f=f.concat([p.a.initializeApp(h.a.firebase),d.b]));var m=function(){function t(){}return t}()},bExo:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"core",description:"Common properties and behavior across all Cyber Observable Objects.",type:"object",properties:{type:{type:"string",pattern:"^\\-?[a-z0-9]+(-[a-z0-9]+)*\\-?$",minLength:3,maxLength:250,description:"Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",not:{enum:["action"]}},description:{type:"string",description:"Specifies a textual description of the Object."},extensions:{$ref:"../common/dictionary.json",description:"Specifies any extensions of the object, as a dictionary."}},patternProperties:{"^[a-z0-9_]{3,250}$":{anyOf:[{type:"array",minItems:1},{type:"string"},{type:"integer"},{type:"boolean"},{type:"number"},{type:"object"}]}},additionalProperties:!1,not:{anyOf:[{required:["action"]}]},required:["type"]}},bouY:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"core",description:"Common properties and behavior across all STIX Domain Objects and STIX Relationship Objects.",type:"object",properties:{type:{title:"type",type:"string",pattern:"^\\-?[a-zA-Z0-9]+(-[a-zA-Z0-9]+)*\\-?$",minLength:3,maxLength:250,description:"The type property identifies the type of STIX Object (SDO, Relationship Object, etc). The value of the type field MUST be one of the types defined by a STIX Object (e.g., indicator).",not:{enum:["incident","infrastructure"]}},id:{$ref:"identifier.json",description:"The id property universally and uniquely identifies this object."},created_by_ref:{$ref:"identifier.json",description:"The ID of the Source object that describes who created this object."},labels:{type:"array",description:"The labels property specifies a set of classifications.",items:{type:"string"},minItems:1},created:{$ref:"timestamp.json",description:"The created property represents the time at which the first version of this object was created."},modified:{$ref:"timestamp.json",description:"The modified property represents the time that this particular version of the object was created."},revoked:{type:"boolean",description:"The revoked property indicates whether the object has been revoked."},external_references:{type:"array",description:"A list of external references which refers to non-STIX information.",items:{$ref:"external-reference.json"},minItems:1},object_marking_refs:{type:"array",description:"The list of marking-definition objects to be applied to this object.",items:{$ref:"identifier.json"},minItems:1},granular_markings:{type:"array",description:"The set of granular markings that apply to this object.",items:{$ref:"granular-marking.json"},minItems:1}},patternProperties:{"^[a-z0-9_]{3,250}$":{anyOf:[{type:"array",minItems:1},{type:"string"},{type:"integer"},{type:"boolean"},{type:"number"},{type:"object"}]}},additionalProperties:!0,not:{anyOf:[{required:["confidence"]},{required:["severity"]},{required:["action"]},{required:["usernames"]},{required:["phone_numbers"]},{required:["addresses"]},{required:["first_seen_precision"]},{required:["last_seen_precision"]},{required:["valid_from_precision"]},{required:["valid_until_precision"]}]},required:["type","id","created","modified"]}},cDNt:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("/oeL"),r=i("p5Ee"),o=i("+h1B"),a=i("fc+i");r.a.production&&i.i(n.a)(),i.i(a.a)().bootstrapModuleFactory(o.a)},d9es:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"report",description:"Reports are collections of threat intelligence focused on one or more topics, such as a description of a threat actor, malware, or attack technique, including context and related details.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `report`.",enum:["report"]},id:{title:"id",pattern:"^report--"},labels:{type:"array",description:"This field is an Open Vocabulary that specifies the primary subject of this report. The suggested values for this field are in report-label-ov.",items:{type:"string"},minItems:1},name:{type:"string",description:"The name used to identify the Report."},description:{type:"string",description:"A description that provides more details and context about Report."},published:{$ref:"../common/timestamp.json",description:"The date that this report object was officially published by the creator of this report."},object_refs:{type:"array",description:"Specifies the STIX Objects that are referred to by this Report.",items:{$ref:"../common/identifier.json"},minItems:1}}}],required:["name","labels","object_refs","published"],definitions:{"report-label-ov":{type:"string",enum:["threat-report","attack-pattern","campaign","identity","indicator","malware","observed-data","threat-actor","tool","vulnerability"]}}}},ivPj:function(t,e,i){e["attack-pattern"]=i("2u+x"),e.campaign=i("pA12"),e["course-of-action"]=i("jXXK"),e.identity=i("Sxy1"),e.indicator=i("YXct"),e["intrusion-set"]=i("0nlO"),e.malware=i("YQ02"),e.report=i("d9es"),e["threat-actor"]=i("jyQV"),e.tool=i("7YP6"),e.vulnerability=i("DI0P")},"j//H":function(t,e,i){e.relationship=i("Jw0n"),e.sighting=i("Q83H")},jXXK:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"course-of-action",description:"A Course of Action is an action taken either to prevent an attack or to respond to an attack that is in progress. ",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `course-of-action`.",enum:["course-of-action"]},id:{title:"id",pattern:"^course-of-action--"},name:{type:"string",description:"The name used to identify the Course of Action."},description:{type:"string",description:"A description that provides more details and context about this object, potentially including its purpose and its key characteristics."}}}],required:["name"]}},jyQV:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"threat-actor",description:"Threat Actors are actual individuals, groups, or organizations believed to be operating with malicious intent.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `threat-actor`.",enum:["threat-actor"]},id:{title:"id",pattern:"^threat-actor--"},labels:{type:"array",description:"This field specifies the type of threat actor. Open Vocab - threat-actor-label-ov",items:{type:"string"},minItems:1},name:{type:"string",description:"A name used to identify this Threat Actor or Threat Actor group."},description:{type:"string",description:"A description that provides more details and context about the Threat Actor."},aliases:{type:"array",description:"A list of other names that this Threat Actor is believed to use.",items:{type:"string"},minItems:1},roles:{type:"array",description:"This is a list of roles the Threat Actor plays. Open Vocab - threat-actor-role-ov",items:{type:"string"},minItems:1},goals:{type:"array",description:"The high level goals of this Threat Actor, namely, what are they trying to do.",items:{type:"string"},minItems:1},sophistication:{type:"string",description:"The skill, specific knowledge, special training, or expertise a Threat Actor must have to perform the attack. Open Vocab - threat-actor-sophistication-ov"},resource_level:{type:"string",description:"This defines the organizational level at which this Threat Actor typically works. Open Vocab - attack-resource-level-ov"},primary_motivation:{type:"string",description:"The primary reason, motivation, or purpose behind this Threat Actor. Open Vocab - attack-motivation-ov"},secondary_motivations:{type:"array",description:"The secondary reasons, motivations, or purposes behind this Threat Actor. Open Vocab - attack-motivation-ov",items:{type:"string"},minItems:1},personal_motivations:{type:"array",description:"The personal reasons, motivations, or purposes of the Threat Actor regardless of organizational goals. Open Vocab - attack-motivation-ov",items:{type:"string"},minItems:1}}}],required:["name","labels"],definitions:{"threat-actor-label-ov":{type:"string",enum:["activist","competitor","crime-syndicate","criminal","hacker","insider-accidental","insider-disgruntled","nation-state","sensationalist","spy","terrorist"]},"threat-actor-role-ov":{type:"string",enum:["agent","director","independent","sponsor","infrastructure-operator","infrastructure-architect","malware-author"]},"threat-actor-sophistication-ov":{type:"string",enum:["none","minimal","intermediate","advanced","strategic","expert","innovator"]},"attack-resource-level-ov":{type:"string",enum:["individual","club","contest","team","organization","government"]},"attack-motivation-ov":{type:"string",enum:["accidental","coercion","dominance","ideology","notoriety","organizational-gain","personal-gain","personal-satisfaction","revenge","unpredictable"]}}}},nF49:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=["pre#raw-stix[_ngcontent-%COMP%]{font-family:Source Code Pro,Monaco,Menlo,Ubuntu Mono,Consolas,source-code-pro,monospace;font-size:12px;white-space:pre-wrap}"]},p5Ee:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n={production:!0,firebase:{apiKey:"AIzaSyA2w2TATnSgUf559_unNUsoCKNklkeQ8Ys",authDomain:"cti-whittler.firebaseapp.com",databaseURL:"https://cti-whittler.firebaseio.com",projectId:"cti-whittler",storageBucket:"cti-whittler.appspot.com",messagingSenderId:"575815532508"}}},pA12:function(t,e){t.exports={$schema:"http://json-schema.org/draft-04/schema#",title:"campaign",description:"A Campaign is a grouping of adversary behavior that describes a set of malicious activities or attacks that occur over a period of time against a specific set of targets.",type:"object",allOf:[{$ref:"../common/core.json"},{properties:{type:{type:"string",description:"The type of this object, which MUST be the literal `campaign`.",enum:["campaign"]},id:{title:"id",pattern:"^campaign--"},name:{type:"string",description:"The name used to identify the Campaign."},description:{type:"string",description:"A description that provides more details and context about the Campaign, potentially including its purpose and its key characteristics."},aliases:{type:"array",description:"Alternative names used to identify this campaign.",items:{type:"string"},minItems:1},first_seen:{$ref:"../common/timestamp.json",description:"The time that this Campaign was first seen."},last_seen:{$ref:"../common/timestamp.json",description:"The time that this Campaign was last seen."},objective:{type:"string",description:"This field defines the Campaign’s primary goal, objective, desired outcome, or intended effect."}}}],required:["name"]}},plal:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var n=["div#d3container{position:absolute;top:0;left:0;right:0;bottom:0}.links path{stroke:#aaa;stroke-width:1;marker-end:url(#end)}.nodes g image{width:30px;height:30px}.nodes text{font-size:16px;stroke-width:10px;stroke:#fff;stroke-opacity:.7;paint-order:stroke}text{font-family:Source Sans Pro,monospace}.link text{text-anchor:middle;font-size:13px}"]},q4dy:function(t,e,i){"use strict";function n(t){return d._25(0,[(t()(),d._26(0,null,null,2,"a",[["href","#"],["ngxClipboard",""]],null,[[null,"click"]],function(t,e,i){var n=!0;if("click"===e){n=!1!==d._29(t,1).onClick(i.target)&&n}if("click"===e){n=!1}return n},null,null)),d._27(212992,null,0,h.a,[u.a,d.O],{targetElm:[0,"targetElm"],cbContent:[1,"cbContent"]},null),(t()(),d._30(null,["Copy Write Link"]))],function(t,e){t(e,1,0,"",e.component.writeLink)},null)}function r(t){return d._25(0,[(t()(),d._26(0,null,null,8,"div",[["class","links"]],null,null,null,null,null)),(t()(),d._30(null,["\n     "])),(t()(),d._26(0,null,null,2,"a",[["href","#"],["ngxClipboard",""]],null,[[null,"click"]],function(t,e,i){var n=!0;if("click"===e){n=!1!==d._29(t,3).onClick(i.target)&&n}if("click"===e){n=!1}return n},null,null)),d._27(212992,null,0,h.a,[u.a,d.O],{targetElm:[0,"targetElm"],cbContent:[1,"cbContent"]},null),(t()(),d._30(null,["Copy Read-Only Link"])),(t()(),d._30(null,["\n     "])),(t()(),d._31(16777216,null,null,1,null,n)),d._27(16384,null,0,f.m,[d.W,d._7],{ngIf:[0,"ngIf"]},null),(t()(),d._30(null,["\n   "]))],function(t,e){var i=e.component;t(e,3,0,"",i.readLink),t(e,7,0,i.writeUUID)},null)}function o(t){return d._25(0,[(t()(),d._26(0,null,null,1,"button",[["href","#"],["type","button"]],null,[[null,"click"]],function(t,e,i){var n=!0,r=t.component;if("click"===e){n=!1!==r.share(i.target)&&n}return n},null,null)),(t()(),d._30(null,["Share"]))],null,null)}function a(t){return d._25(0,[(t()(),d._26(0,null,null,6,"div",[["class","sharing-link"]],null,null,null,null,null)),(t()(),d._30(null,["\n   "])),(t()(),d._31(16777216,null,null,1,null,r)),d._27(16384,null,0,f.m,[d.W,d._7],{ngIf:[0,"ngIf"],ngIfElse:[1,"ngIfElse"]},null),(t()(),d._30(null,["\n  "])),(t()(),d._31(0,[["elseBlock",2]],null,0,null,o)),(t()(),d._30(null,["\n"]))],function(t,e){t(e,3,0,e.component.readUUID,d._29(e,5))},null)}function s(t){return d._25(0,[(t()(),d._26(0,null,null,19,"div",[["id","help-overlay"]],null,null,null,null,null)),(t()(),d._30(null,["\n    "])),(t()(),d._26(0,null,null,7,"div",[["class","section"]],null,null,null,null,null)),(t()(),d._30(null,["\n      "])),(t()(),d._26(0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),d._30(null,["Give it a shot!"])),(t()(),d._30(null,["\n      "])),(t()(),d._26(0,null,null,1,"div",[["class","example"]],null,null,null,null,null)),(t()(),d._30(null,["campaign:\n  name: Shade of Palms\n\nindicator:\n  name: Hash xyz\n  pattern: \"[file.hashes.MD5 = 'xyz']\"\n  kill_chain_phases:\n    -\n      kill_chain_name: lockheed-martin-cyber-kill-chain\n      phase_name: reconnaissance\n\nrelationship:\n  relationship_type: indicates\n  source_ref: 1\n  target_ref: Shade of Palms\n      "])),(t()(),d._30(null,["\n    "])),(t()(),d._30(null,["\n    "])),(t()(),d._26(0,null,null,7,"div",[["class","section"]],null,null,null,null,null)),(t()(),d._30(null,["\n      "])),(t()(),d._26(0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),d._30(null,["Add objects…"])),(t()(),d._30(null,["\n      Objects are each valid YAML, where the key is the type of object and the properties are under that key. Objects should be separated by a new line.\n      "])),(t()(),d._26(0,null,null,1,"h2",[],null,null,null,null,null)),(t()(),d._30(null,["Link 'em together…"])),(t()(),d._30(null,["\n      Relationships can be defined either with a 0-based index to the object or with the name of the object. Anything ending in _ref is considered a relationship.\n    "])),(t()(),d._30(null,["\n  "]))],null,null)}function l(t){return d._25(0,[d._32(402653184,1,{visualizer:0}),d._32(402653184,2,{entryComponent:0}),(t()(),d._26(0,null,null,3,"h1",[],null,null,null,null,null)),(t()(),d._30(null,["CTI Whittler"])),(t()(),d._26(0,null,null,1,"span",[],null,null,null,null,null)),(t()(),d._30(null,["Craft hand-spun, artisanal cyber threat intelligence"])),(t()(),d._30(null,["\n"])),(t()(),d._31(16777216,null,null,1,null,a)),d._27(16384,null,0,f.m,[d.W,d._7],{ngIf:[0,"ngIf"]},null),(t()(),d._30(null,["\n"])),(t()(),d._26(0,null,null,12,"div",[["class","text-panel"]],null,null,null,null,null)),(t()(),d._30(null,["\n  "])),(t()(),d._26(0,null,null,1,"yaml-entry",[],null,[[null,"stixChanged"]],function(t,e,i){var n=!0,r=t.component;if("stixChanged"===e){n=!1!==r.stixChanged(i)&&n}return n},y.a,y.b)),d._27(114688,[[2,4],["yamlEntry",4]],0,g.a,[],{readOnly:[0,"readOnly"]},{stixChanged:"stixChanged"}),(t()(),d._30(null,["\n  "])),(t()(),d._26(0,null,null,1,"raw-stix",[],null,null,null,b.a,b.b)),d._27(114688,null,0,v.a,[],{rawStix:[0,"rawStix"]},null),(t()(),d._30(null,["\n  "])),(t()(),d._26(0,null,null,3,"a",[["href","#"],["id","copy-json"],["ngxClipboard",""]],null,[[null,"click"]],function(t,e,i){var n=!0;if("click"===e){n=!1!==d._29(t,19).onClick(i.target)&&n}if("click"===e){n=!1}return n},null,null)),d._27(212992,null,0,h.a,[u.a,d.O],{targetElm:[0,"targetElm"],cbContent:[1,"cbContent"]},null),d._33(0,f.n,[]),(t()(),d._30(null,["Copy"])),(t()(),d._30(null,["\n"])),(t()(),d._30(null,["\n"])),(t()(),d._26(0,null,null,7,"div",[["class","viz-panel"]],null,null,null,null,null)),(t()(),d._30(null,["\n  "])),(t()(),d._31(16777216,null,null,1,null,s)),d._27(16384,null,0,f.m,[d.W,d._7],{ngIf:[0,"ngIf"]},null),(t()(),d._30(null,["\n  "])),(t()(),d._26(0,null,null,1,"visualizer",[],null,null,null,_.a,_.b)),d._27(114688,[[1,4],["visualizer",4]],0,j.a,[d.P],null,null),(t()(),d._30(null,["\n"])),(t()(),d._30(null,["\n"]))],function(t,e){var i=e.component;t(e,8,0,i.hasDb()),t(e,13,0,i.readOnly),t(e,16,0,i.rawStix);t(e,19,0,"",d._34(e,19,1,d._29(e,20).transform(i.rawStix))),t(e,27,0,!i.readUUID),t(e,30,0)},null)}function c(t){return d._25(0,[(t()(),d._26(0,null,null,3,"app-root",[],null,null,null,l,T)),d._35(512,null,f.e,f.i,[f.f,[2,f.g]]),d._35(512,null,f.h,f.h,[f.e]),d._27(114688,null,0,m.a,[d.P,[2,x.a],w.a,w.c,f.h],null,null)],function(t,e){t(e,3,0)},null)}var p=i("NhKt"),d=i("/oeL"),h=i("KTWJ"),u=i("5sOl"),f=i("qbdv"),m=i("wQAS"),y=i("/Qo4"),g=i("UhKd"),b=i("0vbN"),v=i("PtbZ"),_=i("2S+5"),j=i("I0Gh"),x=i("6cxu"),w=i("BkNc");i.d(e,"a",function(){return O});var k=[p.a],T=d._24({encapsulation:0,styles:k,data:{}}),O=d._28("app-root",m.a,c,{},{},[])},qtrl:function(t,e){function i(t){throw new Error("Cannot find module '"+t+"'.")}i.keys=function(){return[]},i.resolve=i,t.exports=i,i.id="qtrl"},tD1F:function(t,e,i){"use strict";function n(t){return o._25(0,[(t()(),o._26(16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),o._27(212992,null,0,a.y,[a.q,o.W,o.e,[8,null],o.T],null,null)],function(t,e){t(e,1,0)},null)}function r(t){return o._25(0,[(t()(),o._26(0,null,null,1,"root",[],null,null,null,n,c)),o._27(49152,null,0,s.a,[],null,null)],null,null)}var o=i("/oeL"),a=i("BkNc"),s=i("1OLF");i.d(e,"a",function(){return p});var l=[],c=o._24({encapsulation:2,styles:l,data:{}}),p=o._28("root",s.a,r,{},{},[])},wQAS:function(t,e,i){"use strict";var n=i("/oeL"),r=i("qbdv"),o=i("BkNc"),a=i("B2Lq"),s=i("aMZo"),l=(i.n(s),i("0z5Q")),c=(i.n(l),i("Pic8"));i.n(c);i.d(e,"a",function(){return p});var p=function(){function t(t,e,i,n,r){this.help=t,this.db=e,this.route=i,this.router=n,this.location=r,this.readOnly=!0,this.initialLoad=!0}return t.prototype.ngOnInit=function(){var t=this;this.route.params.subscribe(function(e){t.readUUID=e.readUUID,t.writeUUID=e.writeUUID,t.readUUID&&t.subscribe(),t.readUUID&&!t.writeUUID?t.readOnly=!0:t.readOnly=!1})},t.prototype.stixChanged=function(t){this.rawStix=t.bundle,this.rawInput=t.text,this.writeUUID&&t.persist&&(console.log("Writing to firebase: ",this.rawInput),this.db.object("/whittles/"+this.readUUID).set({text:this.rawInput,"write-uuid":this.writeUUID})),this.rawStix.objects&&this.rawStix.objects.length>0&&(this.visualizer.visualize(this.rawStix),l.select("#help-overlay").style("opacity",1).transition().duration(500).style("opacity",0).remove())},t.prototype.subscribe=function(){var t=this;this.db.object("/whittles/"+this.readUUID+"/text").subscribe(function(e){t.rawInput=e.$value,console.log("Got new stix from firebase",e),t.initialLoad&&t.rawInput.length>0&&t.entryComponent.handleNewStix(t.rawInput)})},t.prototype.share=function(){if(void 0!==this.rawInput){var t=i.i(s.v4)(),e=i.i(s.v4)();this.db.object("/whittles/"+t).set({text:this.rawInput,"write-uuid":e}),this.router.navigate(["/whittles/",t,"write",e])}},t.prototype.hasDb=function(){return void 0!==this.db},Object.defineProperty(t.prototype,"readLink",{get:function(){return location.origin+location.pathname+this.location.prepareExternalUrl("whittles/"+this.readUUID)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"writeLink",{get:function(){return location.origin+location.pathname+this.location.prepareExternalUrl("whittles/"+this.readUUID+"/write/"+this.writeUUID)},enumerable:!0,configurable:!0}),t.ctorParameters=function(){return[{type:n.P},{type:a.a,decorators:[{type:n.Z}]},{type:o.a},{type:o.c},{type:r.h}]},t}()}},[0]);